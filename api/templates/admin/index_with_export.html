<!-- https://github.com/django/django/blob/master/django/contrib/admin/templates/admin/index.html -->
{% extends "admin/index.html" %}

{% load static %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'css/admin/extra.css' %}">
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // add click listener
    document.getElementById("action-button").addEventListener("click", function() {
      document.getElementById("spinner").style.display = "block";
      document.getElementById("result-section").style.display = "none";
    });
  });
</script>
{% endblock %}

{% block content %}
<!-- {{ block.super }} -->
<div id="content-main">
  {% include "admin/app_list.html" with app_list=app_list show_changelinks=True %}

  <hr style="margin-top:20px;margin-bottom:20px" />

  <h1>Exporter la donnée vers Github</h1>
  <section class="action-text">
    <p>
      Une fois les questions importées depuis Notion, et les quizs et/ou tags créés, il est temps de mettre à jour l'application.
    </p>
    <p>
      Ce script va exporter toutes les questions, quizzes et tags au format YAML, et créer une Pull Request Github.
    </p>
    <form method="POST">
      {% csrf_token %}
      <input type="hidden" name="run_export_data_to_github_script" value="1" />
      <input id="action-button" type="submit" value="Lancer l'export de la donnée">
    </form>

    <i>⚠️ Veuillez patienter, cela peut prendre un peu de temps</i>

    <div id="spinner" class="loading" role="status" style="display:none"></div>
  </section>

  {% if export_message %}
    <section id="result-section">
      <h2>Résultats : </h2>
      <div>{{ export_message | safe }}</div>
    </section>
  {% endif %}
</div>

{% endblock %}
